<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>C Hex Conversion Utility Examples</title>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/headerfooter.css" rel="stylesheet" />
        <script src="../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="content">
            <div id="contentBody">
                <div class="row collapse">
                    <div class="sideContent">
                        <div class="clearfix">
                        </div>
                    </div>
                    <div id="loadContentArea">
                        <div class="c12 docHeader">
                            <div class="c4 docTitle">
                                <p>
                                    <strong>ARM Assembly
							Language Tools
			v18.1.0.LTS User's Guide</strong>
                                    <br />
                                    <span id="litnumber">SPNU118U</span> - REVISED JANUARY 2018</p>
                            </div>
                        </div>
                    </div>
                    <div class="odsHeader">
                        <p class="pdf">
                            <a class="downloadPDF" href="http://www.ti.com/litv/SPNU118U" target="_new">Download PDF</a>
                        </p>
                    </div>
                    <div id="loadContentArea1">
                        <div class="subsection">
                            <h2 id="SPNU1185824">
                                <a MadCap:generatedBookmark="TOC" name="C_Hex_Conversion_Utility_Examples">
                                </a>
                                <span class="section-label">C </span>Hex Conversion Utility Examples</h2>
                            <div class="subsection">
                                <p>The flexible hex conversion utility offers many options and capabilities. Once you understand the proper ways to configure your EPROM system and the requirements of the EPROM programmer, you will find that converting a file for a specific application is easy.</p>
                                <p>The three scenarios in this appendix show how to develop a hex conversion command file for avoiding holes, using 16-BIS (16-bit instruction set) code, and using multiple-EPROM systems. The scenarios use this assembly code:</p>
                                <code>**************************************************
* Assemble two words into section "secA" *
**************************************************

 .sect "secA" .word 012345678h
 .word 0abcd1234h

**************************************************
* Assemble two words into section "secB" *
**************************************************

 .sect "secB" .word 087654321h
 .word 04321dcbah</code>
                                <p>Before you use this appendix, read <span class="crossreference"><a href="hex-conversion-utility-description.html#STDZ0790730">Section 12</a></span> to understand how to use the hex conversion utility.</p>
                            </div>
                            <div class="subsection">
                                <h3 id="SPNU118464">
                                    <a MadCap:generatedBookmark="TOC" name="C.1_Scenario_1_--_Building_a_Hex_Conversion_Command_File_for_a_Single_8-Bit_E...">
                                    </a>
                                    <span class="section-label">C.1 </span>Scenario 1 -- Building a Hex Conversion Command File for a Single 8-Bit EPROM</h3>
                                <p>Scenario 1 shows how to build the hex conversion command file for converting an object file for the memory system shown in <span class="crossreference"><a href="#SPNU1181368">Figure C-1</a></span>. In this system, there is one external 128K × 8-bit EPROM interfacing with a TMS470 target processor.</p>
                                <div class="figure">
                                    <span class="caption" id="SPNU1181368">
                                        <span class="figure-label">Figure C-1 </span>EPROM Memory System for Scenario 1</span> <img alt="eprom1_pnu118.gif" itemprop="image" src="ods/images/SPNU118U/eprom1_pnu118.gif" title="EPROM Memory System for&#xA;    Scenario 1" /> </div>
                                <p>A object file consists of blocks of memory (sections) with assigned memory locations. Typically, all sections are not adjacent: there are holes between sections in the address space for which there is no data. Scenario 1 shows how you can use the hex conversion utility’s image mode to fill any holes before, between, or after sections with a fill value.</p>
                                <p>For this scenario, the application code resides in the program memory (ROM) on the TMS470 CPU, but the data tables used by this code reside in an off-chip EPROM.</p>
                                <p>The circuitry of the target board handles the access to the data; the native TMS470 address of 0x1000 accesses location 0x0 on the EPROM.</p>
                                <p>To satisfy the address requirements for the code, this scenario requires a linker command file that allocates sections and memory as follows:</p>
                                <ul>
                                    <li value="1">The program/application code (represented in this scenario by the secA section shown in <span class="crossreference"><a href="#SPNU1185298">Example C-1</a></span>) must be linked so that its address space resides in the program memory (ROM) on the TMS470 CPU.</li>
                                    <li value="2">To satisfy the condition that the data be loaded on the EPROM at address 0x0 but be referenced by the application code at address 0x1000, secB (the section that contains the data for this application) must be assigned a linker load address of 0x1000 so that all references to data in this section will be resolved with respect to the TMS470 CPU address. In the hex conversion utility command file, the paddr option must be used to burn the section of data at EPROM address 0x0. This value overrides the section load address given by the linker.</li>
                                </ul>
                                <p>
                                    <span class="crossreference">
                                        <a href="#SPNU1185298">Example C-1</a>
                                    </span> shows the linker command file that resolves the addresses needed in the stated specifications.</p>
                                <div class="example">
                                    <h4 id="SPNU1185298">
                                        <a MadCap:generatedBookmark="TOC" name="Example_C-1_Linker_Command_File_and_Link_Map_for_Scenario_1">
                                        </a>
                                        <span class="example-label">Example C-1 </span>Linker Command File and Link Map for Scenario 1</h4>
                                    <code>/****************************************************************************/
/* Scenario 1 Link Command */
/* */
/* Usage: armlnk &lt;obj files...&gt; -o &lt;out file&gt; -m &lt;map file&gt; lnk32.cmd */
/* armcl &lt;src files...&gt; -z -o &lt;out file&gt; -m &lt;map file&gt; lnk32.cmd */
/* */
/* Description: This file is a sample command file that can be used */
/* for linking programs built with the TMS470 C */
/* compiler. Use it as a guideline; you may want to change */
/* the allocation scheme according to the size of your */
/* program and the memory layout of your target system. */
/* */
/* Notes: (1) You must specify the directory in which rts32.lib is */
/* located. Either add a "-i&lt;directory&gt;" line to this */
/* file, or use the system environment variable C_DIR to */
/* specify a search path for libraries. */
/* */
/* (2) If the runtime-support library you are using is not */
/* named rts32.lib, be sure to use the correct name here. */
/****************************************************************************/
-m example1.map
/* SPECIFY THE SYSTEM MEMORY MAP */
MEMORY
{
 I_MEM : org = 0x00000000 len = 0x00000020 /* INTERRUPTS */
 D_MEM : org = 0x00000020 len = 0x00010000 /* DATA MEMORY (RAM) */
 P_MEM : org = 0x00010020 len = 0x00100000 /* PROGRAM MEMORY (ROM) */
}
/* SPECIFY THE SECTIONS ALLOCATION INTO MEMORY */
SECTIONS
{
 secA: load = P_MEM
 secB: load = 0x1000
}</code>
                                </div>
                                <p>You must create a hex conversion command file to generate a hex output with the correct addresses and format for the EPROM programmer.</p>
                                <p>In the memory system outlined in <span class="crossreference"><a href="#SPNU1181368">Figure C-1</a></span>, only the application data is stored on the EPROM; the data resides in secB of the object file created by the linker. By default, the hex conversion utility converts all initialized sections that appear in the object file. To prevent the conversion of the application code in secA, a SECTIONS directive must be defined in the hex conversion command file to list explicitly the section(s) to be converted. In this case, secB must be listed explicitly as the section to be converted.</p>
                                <p>The EPROM programmer in this scenario has the following system requirements:</p>
                                <ul>
                                    <li value="1">The EPROM programmer loads only a complete ROM image. A complete ROM image is one in which there is a contiguous address space (there are no holes in the addresses in the converted file), and each address in the range contains a known value. Creating a complete ROM image requires the use of the −image option and the ROMS directive.<ul><li value="1">Using the −image option causes the hex conversion utility to create an output file that has contiguous addresses over the specified memory range and forces the utility to fill address spaces that are not previously filled by raw data from sections defined in the input object file. By default, the value used to fill the unused portions of the memory range is 0.</li><li value="2">Because the -image option operates over a known range of memory addresses, a ROMS directive is needed to specify the origin and length of the memory for the EPROM.</li></ul></li>
                                    <li value="2">To burn the section of data at EPROM address 0x0, the paddr option must be used. This value overrides the section load address given by the linker.</li>
                                    <li value="3">In this scenario, the EPROM is 128K × 8 bits. Therefore, the memory addresses for the EPROM must range from 0x0 to 0x20000.</li>
                                    <li value="4">Because the EPROM memory width is eight bits, the memwidth value must be set to 8.</li>
                                    <li value="5">Because the physical width of the ROM device is eight bits, the romwidth value must be set to 8.</li>
                                    <li value="6">Intel format must be used.</li>
                                </ul>
                                <p>Since memwidth and romwidth have the same value, only one output file is generated (the number of output files is determined by the ratio of memwidth to romwidth). The output file is named with the -o option.</p>
                                <p>The hex conversion command file for Scenario 1 is shown in <span class="crossreference"><a href="#SPNU1181507">Example C-2</a></span>. This command file uses the following options to select the requirements of the system:</p>
                                <div class="subsection">
                                    <table class="gentable">
                                        <colgroup>
                                            <col />
                                            <col />
                                        </colgroup>
                                        <thead class="tbl_hdr_gray">
                                            <tr>
                                                <th>Option</th>
                                                <th>Description</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>-i</td>
                                                <td>Create Intel format</td>
                                            </tr>
                                            <tr>
                                                <td>-image</td>
                                                <td>Generate a memory image</td>
                                            </tr>
                                            <tr>
                                                <td>-map example1.mxp</td>
                                                <td>Generate example1.mxp as the map file of the conversion</td>
                                            </tr>
                                            <tr>
                                                <td>-o example1.hex</td>
                                                <td>Name example1.hex as the output file</td>
                                            </tr>
                                            <tr>
                                                <td>-memwidth 8</td>
                                                <td>Set EPROM system memory width to 8</td>
                                            </tr>
                                            <tr>
                                                <td>-romwidth 8</td>
                                                <td>Set physical ROM width to 8</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="example">
                                    <h4 id="SPNU1181507">
                                        <a MadCap:generatedBookmark="TOC" name="Example_C-2_Hex_Conversion_Command_File_for_Scenario_1">
                                        </a>
                                        <span class="example-label">Example C-2 </span>Hex Conversion Command File for Scenario 1</h4>
                                    <code>/* Hex Conversion Command file for Scenario 1 */

a.out /* linked object file, input */
-I /* Intel format */
-image
-map example1.mxp /* Generate a map of the conversion */
-o example1.hex /* Resulting hex output file */
-memwidth 8 /* EPROM memory system width */
-romwidth 8 /* Physical width of ROM */

ROMS
{
 EPROM: origin = 0x0, length = 0x20000
}
 
SECTIONS
{
 secB: paddr = 0x0 /* Select only section, secB, for conversion */
}</code>
                                </div>
                                <p>
                                    <span class="crossreference">
                                        <a href="#SPNU1187911">Example C-3</a>
                                    </span> shows the contents of the resulting map file (example1.mxp). <span class="crossreference"><a href="#SPNU1188768">Figure C-2</a></span> shows the contents of the resulting hex output file (example1.hex). The hex conversion utility places the data tables, secB, at address 0 and then fills the remainder of the address space with the default fill value of 0. For more information about the Intel MCS-86 object format, see <span class="crossreference"><a href="hex-conversion-utility-description.html#STDZ0794635">Figure 12-9</a></span>.</p>
                                <div class="example">
                                    <h4 id="SPNU1187911">
                                        <a MadCap:generatedBookmark="TOC" name="Example_C-3_Contents_of_Hex_Map_File_example1.mxp">
                                        </a>
                                        <span class="example-label">Example C-3 </span>Contents of Hex Map File example1.mxp</h4>
                                    <code>**********************************************************
TMS470 Hex Converter Version x.xx
**********************************************************

Mon Sep 18 15:57:00 1995

INPUT FILE NAME: &lt;a.out&gt;OUTPUT FORMAT: Intel

PHYSICAL MEMORY PARAMETERS
 Default data width: 8
 Default memory width: 8
 Default output width: 8

OUTPUT TRANSLATION MAP
---------------------------------------------------------
00000000..0001ffff Page=0 ROM Width=8 Memory Width=8 "EPROM"---------------------------------------------------------
 OUTPUT FILES: example1.hex [b0..b7]

 CONTENTS: 00000000..00000007 Data Width=1 secB
 00000007..0001ffff FILL = 00000000</code>
                                </div>
                                <div class="figure">
                                    <span class="caption" id="SPNU1188768">
                                        <span class="figure-label">Figure C-2 </span>Contents of Hex Output File example1.hex</span> <img alt="hex_output1_pnu118.gif" itemprop="image" src="ods/images/SPNU118U/hex_output1_pnu118.gif" title="Contents of Hex Output File&#xA;    example1.hex" /> </div>
                            </div>
                            <div class="subsection">
                                <h3 id="SPNU1187302">
                                    <a MadCap:generatedBookmark="TOC" name="C.2_Scenario_2_--_Building_a_Hex_Conversion_Command_File_for_16-BIS_Code">
                                    </a>
                                    <span class="section-label">C.2 </span>Scenario 2 -- Building a Hex Conversion Command File for 16-BIS Code</h3>
                                <p>Scenario 2 shows how to build the hex conversion command file to generate the correct converted file for the application code and data that will reside on a single 16-bit EPROM. The EPROM memory system for this scenario is shown in <span class="crossreference"><a href="#SPNU1185118">Figure C-3</a></span>. For this scenario, the TMS470 CPU operates with the T control bit set, so the processor executes instructions in 16-BIS mode.</p>
                                <div class="figure">
                                    <span class="caption" id="SPNU1185118">
                                        <span class="figure-label">Figure C-3 </span>EPROM Memory System for Scenario 2</span> <img alt="eprom2_pnu118.gif" itemprop="image" src="ods/images/SPNU118U/eprom2_pnu118.gif" title="EPROM Memory System for&#xA;    Scenario 2" /> </div>
                                <p>For this scenario, the application code and data reside on the EPROM: the lower 64K words of EPROM memory are dedicated to application code space and the upper 64K words are dedicated to the data tables. The application code is loaded starting at address 0x0 on the EPROM but maps to the TMS470 CPU at address 0x3000. The data tables are loaded starting at address 0x1000 on the EPROM and map to the TMS470 CPU address 0x20.</p>
                                <p>
                                    <span class="crossreference">
                                        <a href="#SPNU1188708">Example C-4</a>
                                    </span> shows the linker command file that resolves the addresses needed for the load on EPROM and the TMS470 CPU access.</p>
                                <div class="example">
                                    <h4 id="SPNU1188708">
                                        <a MadCap:generatedBookmark="TOC" name="Example_C-4_Linker_Command_File_for_Scenario_2">
                                        </a>
                                        <span class="example-label">Example C-4 </span>Linker Command File for Scenario 2</h4>
                                    <code>/****************************************************************************/
/* Scenario 2 Link Command */
/* */
/* Usage: armlnk &lt;obj files...&gt; -o &lt;out file&gt; -m &lt;map file&gt; lnk16.cmd */
/* armcl &lt;src files...&gt; -z -o &lt;out file&gt; -m &lt;map file&gt; lnk16.cmd */
/* */
/* Description: This file is a sample command file that can be used */
/* for linking programs built with the TMS470 C */
/* compiler. Use it as a guideline; you may want to change */
/* the allocation scheme according to the size of your */
/* program and the memory layout of your target system. */
/* */
/* Notes: (1) You must specify the directory in which rts16.lib is */
/* located. Either add a "-i&lt;directory&gt;" line to this */
/* file, or use the system environment variable C_DIR to */
/* specify a search path for libraries. */
/* */
/* (2) If the runtime-support library you are using is not */
/* named rts16.lib, be sure to use the correct name here. */
/****************************************************************************/

-m example2.map

/* SPECIFY THE SYSTEM MEMORY MAP */

MEMORY
{
 I_MEM : org = 0x00000000 len = 0x00000020 /* INTERRUPTS */
 D_MEM : org = 0x00000020 len = 0x00010000 /* DATA MEMORY (RAM) */
 P_MEM : org = 0x00010020 len = 0x00100000 /* PROGRAM MEMORY (ROM) */
}

/* SPECIFY THE SECTIONS ALLOCATION INTO MEMORY */

SECTIONS
{
 secA: load = 0x3000
 secB: load = 0x20
}</code>
                                </div>
                                <p>You must create a hex conversion command file to generate a hex output with the correct addresses and format for the EPROM programmer. The EPROM programmer in this scenario has the following system requirements:</p>
                                <ul>
                                    <li value="1">Because the EPROM memory width is 16 bits, the memwidth value must be set to 16.</li>
                                    <li value="2">Because the physical width of the ROM device is 16 bits, the romwidth value must be set to 16.</li>
                                    <li value="3">Intel format must be used.</li>
                                </ul>
                                <p>The EPROM programmer does not require a ROM image, so the addresses in the input hex output file do not need to be contiguous.</p>
                                <p>Because memwidth and romwidth have the same value, only one output file is generated (the number of output files is determined by the ratio of memwidth to romwidth). The output file is named with the -o option.</p>
                                <p>A ROMS directive is used in this scenario since the paddr option is used to relocate both secA and secB.</p>
                                <p>The hex conversion command file for Scenario 2 is shown in <span class="crossreference"><a href="#SPNU1182756">Example C-5</a></span>. This command file uses the following options to select the requirements of the system:</p>
                                <div class="subsection">
                                    <table class="gentable">
                                        <colgroup>
                                            <col />
                                            <col />
                                        </colgroup>
                                        <thead class="tbl_hdr_gray">
                                            <tr>
                                                <th>Option</th>
                                                <th>Description</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>-i</td>
                                                <td>Create Intel format</td>
                                            </tr>
                                            <tr>
                                                <td>-map example2.mxp</td>
                                                <td>Generate example2.mxp as the map file of the conversion</td>
                                            </tr>
                                            <tr>
                                                <td>-o example2.hex</td>
                                                <td>Name example2.hex as the output file</td>
                                            </tr>
                                            <tr>
                                                <td>-memwidth 8</td>
                                                <td>Set EPROM system memory width to 8</td>
                                            </tr>
                                            <tr>
                                                <td>-romwidth 8</td>
                                                <td>Set physical ROM width to 8</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="example">
                                    <h4 id="SPNU1182756">
                                        <a MadCap:generatedBookmark="TOC" name="Example_C-5_Hex_Conversion_Command_File_for_Scenario_2">
                                        </a>
                                        <span class="example-label">Example C-5 </span>Hex Conversion Command File for Scenario 2</h4>
                                    <code>/* Hex Conversion Command file for Scenario 2 */
a.out /* linked object file, input */
-I /* Intel format */

 /* The following two options are optional */
-map example2.mxp /* Generate a map of the conversion */
-o example2.hex /* Resulting Hex Output file */

 /* Specify EPROM system Memory Width and Physical ROM width */
-memwidth 16 /* EPROM memory system width */
-romwidth 16 /* Physical width of ROM */

ROMS
{
 EPROM: origin = 0x0, length = 0x20000
}
SECTIONS
{
 secA: paddr = 0x0
 secB: paddr = 0x1000
}</code>
                                </div>
                                <p>
                                    <span class="crossreference">
                                        <a href="#SPNU1186774">Example C-6</a>
                                    </span> shows the contents of the resulting map file (example2.mxp). <span class="crossreference"><a href="#SPNU1184824">Figure C-4</a></span> shows the contents of the resulting hex output file (example2.hex).</p>
                                <div class="example">
                                    <h4 id="SPNU1186774">
                                        <a MadCap:generatedBookmark="TOC" name="Example_C-6_Contents_of_Hex_Map_File_example2.mxp">
                                        </a>
                                        <span class="example-label">Example C-6 </span>Contents of Hex Map File example2.mxp</h4>
                                    <code>*********************************************************
TMS470 Hex Converter Version x.xx
**********************************************************
Mon Sep 18 19:34:47 1995

INPUT FILE NAME: &lt;a.out&gt;OUTPUT FORMAT: Intel

PHYSICAL MEMORY PARAMETERS
 Default data width: 8
 Default memory width: 16
 Default output width: 16

OUTPUT TRANSLATION MAP
---------------------------------------------------------
00000000..0001ffff Page=0 ROM Width=16 Memory Width=16 "EPROM"---------------------------------------------------------
 OUTPUT FILES: example2.hex [b0..b15]

 CONTENTS: 00000000..00000003 Data Width=1 secA
 00001000..00001003 Data Width=1 secB</code>
                                </div>
                                <div class="figure">
                                    <span class="caption" id="SPNU1184824">
                                        <span class="figure-label">Figure C-4 </span>Contents of Hex Output File example2.hex</span> <img alt="hex_output2_pnu118.gif" itemprop="image" src="ods/images/SPNU118U/hex_output2_pnu118.gif" title="Contents of Hex Output File&#xA;    example2.hex" /> </div>
                            </div>
                            <div class="subsection">
                                <h3 id="SPNU1188106">
                                    <a MadCap:generatedBookmark="TOC" name="C.3_Scenario_3_--_Building_a_Hex_Conversion_Command_File_for_Two_8-Bit_EPROMs">
                                    </a>
                                    <span class="section-label">C.3 </span>Scenario 3 -- Building a Hex Conversion Command File for Two 8-Bit EPROMs</h3>
                                <p>Scenario 3 shows how to build the hex conversion command file for converting a object file for the memory system shown in <span class="crossreference"><a href="#SPNU1185433">Figure C-5</a></span>. In this system, there are two external 64K × 16-bit EPROMs interfacing with the TMS470 target processor. The application code and data will be burned on the EPROM starting at address 0x20. The application code will be burned first, followed by the data tables.</p>
                                <div class="figure">
                                    <span class="caption" id="SPNU1185433">
                                        <span class="figure-label">Figure C-5 </span>EPROM Memory System for Scenario 3</span> <img alt="eprom3_pnu118.gif" itemprop="image" src="ods/images/SPNU118U/eprom3_pnu118.gif" title="EPROM Memory System for&#xA;    Scenario 3" /> </div>
                                <p>In this scenario, the EPROM load address for the application code and for the data also corresponds to the TMS470 CPU address that accesses the code and data. Therefore, only a load address needs to be specified.</p>
                                <p>
                                    <span class="crossreference">
                                        <a href="#SPNU118633">Example C-7</a>
                                    </span> shows the linker command file for this scenario.</p>
                                <div class="example">
                                    <h4 id="SPNU118633">
                                        <a MadCap:generatedBookmark="TOC" name="Example_C-7_Linker_Command_File_for_Scenario_3">
                                        </a>
                                        <span class="example-label">Example C-7 </span>Linker Command File for Scenario 3</h4>
                                    <code>/****************************************************************************/
/* Scenario 3 Link Command */
/* */
/* Usage: armlnk &lt;obj files...&gt; -o &lt;out file&gt; -m &lt;map file&gt; lnk32.cmd */
/* armcl &lt;src files...&gt; -z -o &lt;out file&gt; -m &lt;map file&gt; lnk32.cmd */
/* */
/* Description: This file is a sample command file that can be used */
/* for linking programs built with the TMS470 C */
/* compiler. Use it as a guideline; you may want to change */
/* the allocation scheme according to the size of your */
/* program and the memory layout of your target system. */
/* */
/* Notes: (1) You must specify the directory in which rts32.lib is */
/* located. Either add a "-i&lt;directory&gt;" line to this */
/* file, or use the system environment variable C_DIR to */
/* specify a search path for libraries. */
/* */
/* (2) If the runtime-support library you are using is not */
/* named rts32.lib, be sure to use the correct name here. */
/****************************************************************************/

-m example3.map

/* SPECIFY THE SYSTEM MEMORY MAP */

MEMORY
{
 I_MEM : org = 0x00000000 len = 0x00000020 /* INTERRUPTS */
 D_MEM : org = 0x00000020 len = 0x00010000 /* DATA MEMORY (RAM) */
 P_MEM : org = 0x00010020 len = 0x00100000 /* PROGRAM MEMORY (ROM) */
}

/* SPECIFY THE SECTIONS ALLOCATION INTO MEMORY */

SECTIONS
{
 secA: load = 0x20
 secB: load = D_MEM
}
</code>
                                </div>
                                <p>You must create a hex conversion command file to generate a hex output with the correct addresses and format for the EPROM programmer.</p>
                                <p>The EPROM programmer in this scenario has the following system requirements:</p>
                                <ul>
                                    <li value="1">In the memory system outlined in <span class="crossreference"><a href="#SPNU1185433">Figure C-5</a></span>, the EPROM system memory width is 32 bits because each of the physical ROMs provides 16 bits of a 32-bit word. Because the EPROM system memory width is 32 bits, the memwidth value must be set to 32.</li>
                                    <li value="2">Because the width of each of the physical ROMs is 16 bits, the romwidth value must be set to 16.</li>
                                    <li value="3">Intel format must be used.</li>
                                </ul>
                                <p>With a memwidth of 32 and a romwidth of 16, two output files are generated by the hex conversion utility (the number of files is determined by the ratio of memwidth to romwidth). In previous scenarios, the output filename was specified with the -o option. Another way to specify the output filename is to use the files keyword within a ROMS directive. When you use -o or the files keyword, the first output filename always contains the low-order bytes of the word.</p>
                                <p>The hex conversion command file for Scenario 3 is shown in <span class="crossreference"><a href="#SPNU1181444">Example C-8</a></span>. This command file uses the following options to select the requirements of the system:</p>
                                <div class="subsection">
                                    <table class="gentable">
                                        <colgroup>
                                            <col />
                                            <col />
                                        </colgroup>
                                        <thead class="tbl_hdr_gray">
                                            <tr>
                                                <th>Option</th>
                                                <th>Description</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>-i</td>
                                                <td>Create Intel format</td>
                                            </tr>
                                            <tr>
                                                <td>-map example3.mxp</td>
                                                <td>Generate example3.mxp as the map file of the conversion</td>
                                            </tr>
                                            <tr>
                                                <td>-memwidth 32</td>
                                                <td>Set EPROM system memory width to 32</td>
                                            </tr>
                                            <tr>
                                                <td>-romwidth 16</td>
                                                <td>Set physical ROM width to 16</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <p>The files keyword is used within the ROMS directive to specify the output filenames.</p>
                                <div class="example">
                                    <h4 id="SPNU1181444">
                                        <a MadCap:generatedBookmark="TOC" name="Example_C-8_Hex_Conversion_Command_File_for_Scenario_3">
                                        </a>
                                        <span class="example-label">Example C-8 </span>Hex Conversion Command File for Scenario 3</h4>
                                    <code>/* Hex Conversion Command file for Scenario 3 */
a.out /* linked object file, input */
-I /* Intel format */
 /* Optional Commands */
-map example3.mxp /* Generate a map of the conversion */
 /* Specify EPROM system memory width and physical ROM width */
-memwidth 32 /* EPROM memory system width */
-romwidth 16 /* Physical width of ROM */
ROMS
{
 EPROM: org = 0x0, length = 0x20000
 files={ lower16.bit, upper16.bit }
}</code>
                                </div>
                                <p>
                                    <span class="crossreference">
                                        <a href="#SPNU1187396">Example C-9</a>
                                    </span> shows the contents of the resulting map file (example3.mxp).</p>
                                <div class="example">
                                    <h4 id="SPNU1187396">
                                        <a MadCap:generatedBookmark="TOC" name="Example_C-9_Contents_of_Hex_Map_File_example3.mxp">
                                        </a>
                                        <span class="example-label">Example C-9 </span>Contents of Hex Map File example3.mxp</h4>
                                    <code>**********************************************************
TMS470 Hex Converter Version x.xx
**********************************************************
Tue Sep 19 07:41:28 1995

INPUT FILE NAME: &lt;a.out&gt;OUTPUT FORMAT: Intel

PHYSICAL MEMORY PARAMETERS
 Default data width: 8
 Default memory width: 32
 Default output width: 16

OUTPUT TRANSLATION MAP
---------------------------------------------------------
00000000..0001ffff Page=0 ROM Width=16 Memory Width=32 "EPROM"---------------------------------------------------------
 OUTPUT FILES: lower16.bit [b0..b15]
 upper16.bit [b16..b31]

 CONTENTS: 00000020..00000021 Data Width=1 secA
 00000028..00000029 Data Width=1 secB</code>
                                </div>
                                <p>The contents of the output files lower16.bit and upper16.bit are shown in <span class="crossreference"><a href="#SPNU1184515">Figure C-6</a></span> and <span class="crossreference"><a href="#SPNU1182438">Figure C-7</a></span>, respectively. The low-order 16 bits of the 32-bit output word are stored in the lower16.bit file, while the upper 16 bits are stored in the upper16.bit file.</p>
                                <div class="figure">
                                    <span class="caption" id="SPNU1184515">
                                        <span class="figure-label">Figure C-6 </span>Contents of Hex Output File lower16.bit</span> <img alt="lower16_pnu118.gif" itemprop="image" src="ods/images/SPNU118U/lower16_pnu118.gif" title="Contents of Hex Output File&#xA;    lower16.bit" /> </div>
                                <div class="figure">
                                    <span class="caption" id="SPNU1182438">
                                        <span class="figure-label">Figure C-7 </span>Contents of Hex Output File upper16.bit</span> <img alt="upper16_pnu118.gif" itemprop="image" src="ods/images/SPNU118U/upper16_pnu118.gif" title="Contents of Hex Output File&#xA;    upper16.bit" /> </div>
                            </div>
                        </div>
                    </div>
                    <a href="../Resources/MasterPages/..SPNU118U_HTML/abstract.html">Back to Top</a>
                    <p />
                    <a href="http://www.go-dsp.com/forms/techdoc/doc_feedback.htm?litnum=SPNU118U&amp;partnum=ARM">Submit Documentation Feedback</a>
                    <p>Copyright© 2018, Texas Instruments Incorporated. An <a href="includes/important_notice.html">IMPORTANT NOTICE</a> for this document addresses availability, warranty, changes, use in safety-critical applications, intellectual property matters and other important disclaimers.</p>
                </div>
            </div>
        </div>
    </body>
</html>