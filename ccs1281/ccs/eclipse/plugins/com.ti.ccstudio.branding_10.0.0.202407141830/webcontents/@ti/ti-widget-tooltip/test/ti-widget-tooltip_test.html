<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">
    <title>ti-widget-tooltip test</title>

    <script src="../../../test/environment.js"></script>
    <script type="module" src="../ti-widget-tooltip"></script>
</head>

<body>
    <test-fixture id="BasicTestFixture">
        <template>
            <div id="testDiv1">testDiv1</div>
            <div id="testDiv2">testDiv2</div>
            <ti-widget-tooltip id="tooltip" text="A test tooltip"></ti-widget-tooltip>
        </template>
    </test-fixture>


    <script type="module">
        window.runTest = () => {
            suite('ti-widget-tooltip', () => {
                test('anchorId property works', () => {
                    const element = fixture('BasicTestFixture');
                    const testDiv1 = element[0];
                    const testDiv2 = element[1];
                    const tooltip = element[2];

                    return executeAndWait([() => {
                        // Set the anchor to testDiv1
                        tooltip.anchorId = 'testDiv1';
                        assert.isTrue(tooltip.tooltip.$.tooltip.classList.contains('hidden'));
                    }, () => {
                        // Simulate hover over testDiv1
                        let event = new Event('mouseenter');
                        testDiv1.dispatchEvent(event);
                    }, () => {
                        // Check that the tooltip is visible
                        assert.isFalse(tooltip.tooltip.$.tooltip.classList.contains('hidden'));
                    }, () => {
                        // Hide the tooltip by leaving the div
                        let event = new Event('mouseleave');
                        testDiv1.dispatchEvent(event);
                    }, () => {
                        // Set the anchor to testDiv2
                        tooltip.anchorId = 'testDiv2';
                        assert.isTrue(tooltip.tooltip.$.tooltip.classList.contains('hidden'));
                    }, () => {
                        // Simulate hover over testDiv2
                        let event = new Event('mouseenter');
                        testDiv2.dispatchEvent(event);
                    }, () => {
                        // Check that the tooltip is visible
                        assert.isFalse(tooltip.tooltip.$.tooltip.classList.contains('hidden'));
                    }]);
                });

                test('offset property works', () => {
                    const element = fixture('BasicTestFixture');
                    const tooltip = element[2];

                    tooltip.offset = 20;
                    assert.equal(tooltip.tooltip.offset, 20);
                });

                test('position property works', () => {
                    const element = fixture('BasicTestFixture');
                    const tooltip = element[2];

                    tooltip.position = "left";
                    assert.equal(tooltip.tooltip.position, "left");
                });

                test('text property works', () => {
                    const element = fixture('BasicTestFixture');
                    const tooltip = element[2];

                    tooltip.text = "Hello world!";
                    assert.equal(tooltip.tooltip.textContent.trim(), "Hello world!");
                });
            });
        }
    </script>
</body>

</html>