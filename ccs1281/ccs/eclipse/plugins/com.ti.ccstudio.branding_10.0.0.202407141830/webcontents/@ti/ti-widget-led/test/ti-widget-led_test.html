<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">
    <title>ti-widget-led test</title>

    <script src="../../../test/environment.js"></script>
    <script type="module" src="../ti-widget-led"></script>
</head>

<body>
    <!-- fixture resets DOM state between test runs -->
    <test-fixture id="BasicTestFixture">
        <template>
            <ti-widget-led id="demo-element"></ti-widget-led>
        </template>
    </test-fixture>

    <script type="module">
        import { TIWidgetBaseTest } from '../../ti-widget-base/test/ti-widget-base_test';
        window.runTest = () => {

            // Widget tests
            suite('ti-widget-led', () => {

                let element;
                setup(() => {
                    element = fixture('BasicTestFixture');
                });

                test('initialized led works', () => {

                    return wait().then(() => {
                        assert.isFalse(element.on);
                        assert.isTrue(element.glow);

                        // check default colours on
                        const led = element.shadowRoot.querySelector("#led_path");
                        const glow = element.shadowRoot.querySelector("#glow_path");
                        const outerCircle = element.shadowRoot.querySelector("#led_res_path");
                        assert.strictEqual(led.getAttribute("fill"), '#696969');
                        assert.strictEqual(glow.getAttribute("fill"), '#696969');
                        assert.strictEqual(outerCircle.getAttribute("fill"), '#696969');

                    });
                });

                test('change on color works', () => {
                    const led = element.shadowRoot.querySelector("#led_path");
                    const glow = element.shadowRoot.querySelector("#glow_path");
                    const outerCircle = element.shadowRoot.querySelector("#led_res_path");

                    // fillStyle is in string rgb style, so 'blue' = '#00f'
                    element.setCSSProperty('--ti-widget-led-on-color', 'blue');
                    element.on = true;

                    assert.strictEqual(led.getAttribute("fill"), 'blue');
                    assert.strictEqual(glow.getAttribute("fill"), 'blue');
                    assert.strictEqual(outerCircle.getAttribute("fill"), 'blue');
                });

                test('change off color works', () => {
                    const led = element.shadowRoot.querySelector("#led_path");
                    const glow = element.shadowRoot.querySelector("#glow_path");
                    const outerCircle = element.shadowRoot.querySelector("#led_res_path");

                    element.setCSSProperty('--ti-widget-led-off-color', 'dodgerblue');
                    assert.strictEqual(led.getAttribute("fill"), 'dodgerblue');
                    assert.strictEqual(glow.getAttribute("fill"), 'dodgerblue');
                    assert.strictEqual(outerCircle.getAttribute("fill"), 'dodgerblue');
                });

                test('glow toggle works', () => {
                    const glow = element.shadowRoot.querySelector("#glow-circle");
                    element.on = true;
                    assert.strictEqual(glow.style.display, "inline");

                    element.glow = false;
                    assert.strictEqual(glow.style.display, "none");
                });
            });
        }
    </script>
</body>

</html>