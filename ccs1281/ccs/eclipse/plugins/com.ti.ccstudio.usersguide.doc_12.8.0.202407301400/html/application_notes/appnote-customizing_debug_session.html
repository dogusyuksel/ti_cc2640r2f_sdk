<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">

<!-- OPTIONAL BUT RECOMMENDED: Add a summary for your page below, then remove the comments. The summary should inform users what the page is about (within 160 chars). It will appear in Google search results below the Title and can have a huge effect on click-through rate -->
<meta name="description" content="When working with a specific project, it is usual to have a specific set of views, graphs, variables, breakpoints and expressions already pre-populated so at the start of every Debug Session you can easily resume from a previous configuration. This application note describes a few practical tips to accomplish that, by customizing and automating some operations of a debug session using the scripting tool built into Code Composer Studio."> 

<!-- Change the product name and link if desired -->
<meta name="product-name" content="Code Composer Studio">
<meta name="product-link" content="https://www.ti.com/tool/CCSTUDIO">

<!-- Change the title text for your page -->
<title>Customizing a debug session</title>

<script src='https://software-dl.ti.com/ccs/esd/documents/web_support_v2/loader.js'></script>

</head>

<xmp theme="united2" style="display:none;" class="col-xs-6">

<!-- Start of markdown source -->
# Overview
When working with a specific project, it is usual to have a specific set of views, graphs, variables, breakpoints and expressions already pre-populated so at the start of every Debug Session you can easily resume from a previous configuration.

This application note describes a few practical tips to accomplish that, by customizing and automating some operations of a debug session using the scripting tool built into Code Composer Studio.  

This application note does not exhaust the subject and will be continuously updated. 

# References

* [Scripting Console](../ccsv7_scripting_console.html)
* [Debug Server Scripting](../users_guide/sdto_dss_handbook.html)
* [PRU-ICSS Debug on AM335x](http://processors.wiki.ti.com/index.php/PRU-ICSS_Debug_on_AM335x)

# The procedure
The process of adding these elements (variables, graphs, breakpoints) to a debug session cannot be fully automated - i.e., to add these elements to a debug session, a core must be connected and either a program or its debug symbols needs to be loaded, so the javascript routines are able to properly find the variable names. However, the addition of these elements can be simplified to a simple click. 

The addition of variables can be simplified to a single click, which starts with the common steps:

- Open the Debug session you are working on.
- Open the scripting console view (menu <i>View</i> &rarr; <i>Scripting Console</i>). This is useful to get help for the different commands used below and to test its parameters.

## Expressions

The command to add an expression is called <font color="#0000f0"><tt>expAdd()</tt></font>. Using the scripting console view, you can get its help to see the parameters:

<pre><code>
js:> help expAdd

Description: Add an expression to the expression view
Syntax: expAdd(expression)
Arguments:
  expression - the expression to add to the expression view

Description: Add an expression to the expression view with a given format
Syntax: expAdd(expression,format)
Arguments:
expression - the expression to add to the expression view
format - the display format that will be tried to use (if reasonable) when the value of expression is displayed 
This is an optional parameter. The format can be obtained from getHex, getDecimal, getBinary, getNatural, and getQValue.
</code></pre>

<br>

Create a new file (menu <i>File</i> &rarr; <i>Other</i> &rarr; <i>General</i> &rarr; <i>File</i>) and store it into your project directory. Give it a .js extension.

<br>

Open this file (sometimes it is needed to right click on it and select <i>Open With</i> &rarr; <i>Text Editor</i>) then pass the commands to add variables, Memory-mapped registers (MMRs) and C-language expressions  with a single mouse click. The example script below adds a menu entry named Show variables to the Scripts menu of the Debug session.

<pre><code>
function load_vars()
{
  expRemoveAll();
  expAdd('REG_SYSTEM_MEM_VALID',getHex());
  expAdd('saram_start',getNatural());
  expAdd('count',getDecimal());
  expAdd('adcBuf[3]<<8',getHex());
}

hotmenu.addJSFunction("Show variables","load_vars()");
</code></pre>

<br>

To use this newly created file, go back to the scripting console view and use the command <font color="#0000f0"><tt>loadJSfile()</tt></font> with the last parameter as true, so it can be automatically loaded when the debug session starts. 

<pre><code>
loadJSFile("C:\Users\user\workspace_v8\my_proj\show_variables.js",true);
</code></pre>

## Breakpoints

Similar syntax can be used to set breakpoints automatically by using the command <font color="#0000f0"><tt>ba()</tt></font> - Breakpoint Add. 

<pre><code>
js:> help ba

Description: Add a software breakpoint, depends on the input argument, different type of breakpoint will be added. If arg1 is null, than it will be added as an address breakpoint or a symbolic breakpoint. If both arguments are not null, source breakpoint will be added, the first argument must be a string and the second argument must be a number.
Syntax: ba(arg0,arg1)
Arguments: 
  arg0 - can be address (number) or symbolic (string).
  arg1 - the line number, if and only if arg0 is a file.
Returns: the breakpoint index handle.
</code></pre>

<br>

And easily add a specific function and the menu entry to add these breakpoints, either to a function or a line at a source file of the active project:

<pre><code>
function add_bkpts()
{
ba('adcProcess')
ba('main.c',139)
}

hotmenu.addJSFunction("Add Breakpoints",add_bkpts()");
</code></pre>

## Graphs

Just like the other previous cases, setting up graphs can be easily done as well. However, the only detail is that a graph properties file must be previously created: 

- In the active debug session, open a graph (menu <i>Tools</i> &rarr; <i>Graph</i> &rarr; and one of the options listed). 
- Set it up with the desired settings for Acquisition Buffer Size, Dsp Data Type, etc.
- Click on the button <i>Export</i> and save its configuration data to a file in your project - it will have the default extension .graphProp

After that, use the function <font color="#0000f0"><tt>openAnalysisView()</tt></font>

<pre><code>
js:> help openAnalysisView 
                                                                            
Description: opens an Analysis View.  E.g. to open a single time graph, openAnalysisView('Single Time','C:\\abc.graphProp')
Syntax: openAnalysisView(viewID,arg)
Arguments: 
  viewID - Name of the view. Please see feature specific view names For CCS Graphs Feature: 'Single Time', 'Dual Time',  'FFT Magnitude', 'FFT Magnitude Phase', 'Complex FFT', 'FFT Waterfall'
  arg - See feature specific interpretation of this argument For CCS Graphs: Used as a property file from which to load the graph property values
</code></pre>

<br>

And easily add a specific function and the menu entry to add the graph:

<pre><code>
function open_graph()
{
openAnalysisView('Dual Time','C:/Users/user/workspace_v8/my_proj/my_proj_graph.graphProp')
}

hotmenu.addJSFunction("Show graph","open_graph()");
</code></pre>

<hr>
<!-- End of markdown source -->

<div id="footer"></div>

</xmp>
</html>
